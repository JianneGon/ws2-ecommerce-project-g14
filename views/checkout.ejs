<h1 class="page-title">Checkout</h1>

<div class="form-container">
  <h2 class="form-title">Review Your Order</h2>
  <p class="form-subtitle">Confirm your details to complete your purchase.</p>

  <% if (typeof cart !== "undefined" && cart && cart.items && cart.items.length > 0) { %>

    <!-- =============================
         CART CHECKOUT (multiple items)
    ============================== -->
    <div class="dashboard-info">
      <h3 style="margin-bottom:10px;">Items in Cart</h3>

      <ul style="padding-left:18px; line-height:1.7;">
        <% cart.items.forEach(item => { %>
          <li>
            <strong><%= item.name %></strong> — 
            <%= item.quantity %> × ₱<%= item.price.toFixed(2) %>  
            = ₱<%= item.subtotal.toFixed(2) %>
          </li>
        <% }) %>
      </ul>

      <p><strong>Total Items:</strong> <%= cart.totalQty %></p>
      <p><strong>Total Amount:</strong> ₱<%= cart.totalAmount.toFixed(2) %></p>
    </div>

    <form action="/cart/checkout" method="POST" class="reset-form" style="margin-top:25px;">
      <input type="text" name="fullName" placeholder="Full Name" required>
      <input type="text" name="addressLine1" placeholder="Address Line 1" required>
      <input type="text" name="addressLine2" placeholder="Address Line 2 (Optional)">
      <input type="text" name="city" placeholder="City" required>
      <input type="text" name="region" placeholder="Region / Province" required>
      <input type="text" name="postalCode" placeholder="Postal Code" required>
      <input type="text" name="phone" placeholder="Mobile Number" required>

      <button type="submit" class="btn-submit">Place Order</button>
    </form>

  <% } else { %>

    <!-- =============================
         SINGLE PRODUCT CHECKOUT
    ============================== -->
    <div class="dashboard-info">
      <p><strong>Product:</strong> <%= product.name %></p>
      <p><strong>Brand:</strong> <%= product.brand %></p>
      <p><strong>Price:</strong> ₱<%= product.price.toFixed(2) %></p>
      <p><strong>Quantity:</strong> <%= quantity %></p>
      <p><strong>Total:</strong> ₱<%= totalAmount.toFixed(2) %></p>
    </div>

    <form action="/orders/checkout" method="POST" class="reset-form" style="margin-top:25px;">
      <input type="hidden" name="productId" value="<%= product.productId %>">
      <input type="hidden" name="quantity" value="<%= quantity %>">

      <input type="text" name="fullName" placeholder="Full Name" required>
      <input type="text" name="addressLine1" placeholder="Address Line 1" required>
      <input type="text" name="addressLine2" placeholder="Address Line 2 (Optional)">
      <input type="text" name="city" placeholder="City" required>
      <input type="text" name="region" placeholder="Region / Province" required>
      <input type="text" name="postalCode" placeholder="Postal Code" required>
      <input type="text" name="phone" placeholder="Mobile Number" required>

      <button type="submit" class="btn-submit">Place Order</button>
    </form>

  <% } %>
</div>
